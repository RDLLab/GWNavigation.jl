function GWNavigationPOMDP(;grid_size::Int=20)
    if grid_size == 20
        return get_20x20_gw_problem()
    elseif grid_size == 60
        return get_60x60_gw_problem()
    else
        error("Unsupported grid size. Supported values are 20 and 60.")
    end
end

function GWNavigationPOMDP(
    grid_size::Tuple{Int, Int},
    obstacles::Vector{Tuple{Int, Int}},
    landmarks::Vector{Tuple{Int, Int}},
    danger::Vector{Tuple{Int, Int}},
    goals::Vector{Tuple{Int, Int}},
    initial_states::Vector{Tuple{Int, Int}};
    transition_prob::Float64=0.1,
    discount_factor::Float64=0.99,
    danger_state_penalty::Float64=-100.0,
    goal_state_reward::Float64=200.0,
    step_penalty::Float64=-1.0,
    scaling_factor::Int=1,
)
    goal_states = Set(GWState(s[1], s[2]) for s in goals)
    obstacle_states = Set(GWState(s[1], s[2]) for s in obstacles)
    landmark_states = Set(GWState(s[1], s[2]) for s in landmarks)
    danger_states = Set(GWState(s[1], s[2]) for s in danger)

    initial_states = Set(GWState(s[1], s[2]) for s in initial_states)

    all_states = Set(GWState(x, y) for x in 1:grid_size[1], y in 1:grid_size[2])
    special_states = union(goal_states, obstacle_states, landmark_states, danger_states)
    free_states_set = setdiff(all_states, special_states)

    free_states_dict = Dict(s => i for (i, s) in enumerate(free_states_set))

    offset = length(free_states_dict)
    goal_states_dict = Dict(s => i + offset for (i, s) in enumerate(goal_states))
    offset += length(goal_states_dict)
    landmark_states_dict:: Dict{GWState, Int} = Dict()   # To handle overlapping goal and landmark states
    offset_ajustment = 0
    for (i, s) in enumerate(landmark_states)
        if haskey(goal_states_dict, s)
            offset_ajustment += 1
            landmark_states_dict[s] = goal_states_dict[s]  # Assign the same index as the goal state
        else
            landmark_states_dict[s] = i + offset_ajustment
        end
    end
    offset = length(union(keys(goal_states_dict), keys(landmark_states_dict))) + length(free_states_dict)
    danger_states_dict = Dict(s => i + offset for (i, s) in enumerate(danger_states))

    observation_dict::Dict{GWObservation, Int} = Dict(GWNullObservation => 1) # Null observation
    observations_to_states = Dict{GWObservation, Set{GWState}}()
    obs_idx = 2
    for landmark in keys(landmark_states_dict)
        for observable_s in get_neighbors(landmark, grid_size)
            obs = GWObservation(observable_s)
            if !haskey(observation_dict, obs)
                observation_dict[obs] = obs_idx
                obs_idx += 1
            end
            if haskey(observations_to_states, obs)
                push!(observations_to_states[obs], landmark)
            else
                observations_to_states[obs] = Set{GWState}([landmark])
            end
        end
    end

    return GWNavigationPOMDP(
        grid_size,
        free_states_dict,
        goal_states_dict,
        obstacle_states,
        landmark_states_dict,
        danger_states_dict,
        initial_states,
        observation_dict,
        observations_to_states,
        transition_prob,
        discount_factor,
        danger_state_penalty,
        goal_state_reward,
        step_penalty,
        scaling_factor,
    )
end

function get_20x20_gw_problem()
    obstacles_20x20 = [(2, 1), (2, 2), (2, 3), (2, 6), (2, 7), (2, 8), (2, 9), (2, 10), (2, 11), (2, 12), (2, 15), (2, 16), (2, 17), (2, 18), (8, 1), (8, 2), (8, 3), (10, 6), (10, 7), (10, 8), (10, 9), (10, 10), (10, 11), (10, 12), (10, 15), (10, 16), (10, 17), (10, 18), (14, 1), (14, 2), (14, 3), (14, 4), (14, 5), (14, 6), (14, 11), (14, 12), (14, 13), (14, 14), (14, 15), (14, 16), (14, 17), (14, 18), (14, 19), (14, 20), (2, 3), (3, 3), (5, 3), (6, 3), (7, 3), (8, 3), (9, 3), (10, 3), (12, 3), (13, 3), (14, 3), (14, 8), (15, 8), (16, 8), (17, 8), (18, 8), (19, 8), (20, 8), (14, 11), (15, 11), (16, 11), (19, 11), (20, 11), (2, 12), (3, 12), (4, 12), (5, 12), (6, 12), (7, 12), (8, 12), (9, 12), (2, 15), (3, 15), (4, 15), (5, 15), (6, 15), (7, 15), (8, 15), (9, 15), (2, 18), (3, 18), (5, 18), (6, 18), (7, 18), (8, 18), (9, 18)]

    landmarks_20x20 = [(15, 12), (15, 13), (16, 12), (16, 13), (17, 12), (17, 13), (18, 6), (18, 7), (19, 6), (19, 7), (20, 6), (20, 7), (12, 8), (3, 19), (1, 17), (1, 20), (10, 19), (13, 20), (10, 13), (11, 15), (14, 10), (18, 10)]

    danger_20x20 = [(20, 9), (20, 10), (6, 19), (7, 19), (8, 19), (4, 4), (4, 5), (5, 4), (5, 5), (6, 4), (6, 5), (7, 4), (7, 5), (8, 4), (8, 5), (9, 4), (9, 5)]

    goals_20x20 = [(16, 12), (19, 7)]

    init_states_20x20 = [(1, 4), (1, 14)]

    return GWNavigationPOMDP(
        (20, 20),
        obstacles_20x20,
        landmarks_20x20,
        danger_20x20,
        goals_20x20,
        init_states_20x20;
        scaling_factor=1
    )
end

# function get_40x40_gw_problem()
#     grid_size, obstacles, landmarks, danger, goals, init_states = scale_grid_world(
#         (20, 20),
#         obstacles_20x20,
#         landmarks_20x20,
#         danger_20x20,
#         goals_20x20,
#         init_states_20x20,
#         2,
#     )
#     return GWNavigationPOMDP(
#         grid_size,
#         obstacles,
#         landmarks,
#         danger,
#         goals,
#         init_states;
#         scaling_factor=2.0
#     )
# end

function get_60x60_gw_problem()
    obstacles_60x60 = [(6, 3), (6, 4), (6, 5), (6, 6), (6, 7), (6, 8), (6, 9), (6, 10), (6, 11), (6, 18), (6, 19), (6, 20), (6, 21), (6, 22), (6, 23), (6, 24), (6, 25), (6, 26), (6, 27), (6, 28), (6, 29), (6, 30), (6, 31), (6, 32), (6, 33), (6, 34), (6, 35), (6, 36), (6, 37), (6, 38), (6, 45), (6, 46), (6, 47), (6, 48), (6, 49), (6, 50), (6, 51), (6, 52), (6, 53), (6, 54), (6, 55), (6, 56), (7, 3), (7, 4), (7, 5), (7, 6), (7, 7), (7, 8), (7, 9), (7, 10), (7, 11), (7, 18), (7, 19), (7, 20), (7, 21), (7, 22), (7, 23), (7, 24), (7, 25), (7, 26), (7, 27), (7, 28), (7, 29), (7, 30), (7, 31), (7, 32), (7, 33), (7, 34), (7, 35), (7, 36), (7, 37), (7, 38), (7, 45), (7, 46), (7, 47), (7, 48), (7, 49), (7, 50), (7, 51), (7, 52), (7, 53), (7, 54), (7, 55), (7, 56), (8, 3), (8, 4), (8, 5), (8, 6), (8, 7), (8, 8), (8, 9), (8, 10), (8, 11), (8, 18), (8, 19), (8, 20), (8, 21), (8, 22), (8, 23), (8, 24), (8, 25), (8, 26), (8, 27), (8, 28), (8, 29), (8, 30), (8, 31), (8, 32), (8, 33), (8, 34), (8, 35), (8, 36), (8, 37), (8, 38), (8, 45), (8, 46), (8, 47), (8, 48), (8, 49), (8, 50), (8, 51), (8, 52), (8, 53), (8, 54), (8, 55), (8, 56), (9, 9), (9, 10), (9, 11), (9, 36), (9, 37), (9, 38), (9, 45), (9, 46), (9, 47), (9, 54), (9, 55), (9, 56), (10, 9), (10, 10), (10, 11), (10, 36), (10, 37), (10, 38), (10, 45), (10, 46), (10, 47), (10, 54), (10, 55), (10, 56), (11, 9), (11, 10), (11, 11), (11, 36), (11, 37), (11, 38), (11, 45), (11, 46), (11, 47), (11, 54), (11, 55), (11, 56), (12, 36), (12, 37), (12, 38), (12, 45), (12, 46), (12, 47), (13, 36), (13, 37), (13, 38), (13, 45), (13, 46), (13, 47), (14, 36), (14, 37), (14, 38), (14, 45), (14, 46), (14, 47), (15, 9), (15, 10), (15, 11), (15, 36), (15, 37), (15, 38), (15, 45), (15, 46), (15, 47), (15, 54), (15, 55), (15, 56), (16, 9), (16, 10), (16, 11), (16, 36), (16, 37), (16, 38), (16, 45), (16, 46), (16, 47), (16, 54), (16, 55), (16, 56), (17, 9), (17, 10), (17, 11), (17, 36), (17, 37), (17, 38), (17, 45), (17, 46), (17, 47), (17, 54), (17, 55), (17, 56), (18, 9), (18, 10), (18, 11), (18, 36), (18, 37), (18, 38), (18, 45), (18, 46), (18, 47), (18, 54), (18, 55), (18, 56), (19, 9), (19, 10), (19, 11), (19, 36), (19, 37), (19, 38), (19, 45), (19, 46), (19, 47), (19, 54), (19, 55), (19, 56), (20, 9), (20, 10), (20, 11), (20, 36), (20, 37), (20, 38), (20, 45), (20, 46), (20, 47), (20, 54), (20, 55), (20, 56), (21, 9), (21, 10), (21, 11), (21, 36), (21, 37), (21, 38), (21, 45), (21, 46), (21, 47), (21, 54), (21, 55), (21, 56), (22, 9), (22, 10), (22, 11), (22, 36), (22, 37), (22, 38), (22, 45), (22, 46), (22, 47), (22, 54), (22, 55), (22, 56), (23, 9), (23, 10), (23, 11), (23, 36), (23, 37), (23, 38), (23, 45), (23, 46), (23, 47), (23, 54), (23, 55), (23, 56), (24, 3), (24, 4), (24, 5), (24, 6), (24, 7), (24, 8), (24, 9), (24, 10), (24, 11), (24, 36), (24, 37), (24, 38), (24, 45), (24, 46), (24, 47), (24, 54), (24, 55), (24, 56), (25, 3), (25, 4), (25, 5), (25, 6), (25, 7), (25, 8), (25, 9), (25, 10), (25, 11), (25, 36), (25, 37), (25, 38), (25, 45), (25, 46), (25, 47), (25, 54), (25, 55), (25, 56), (26, 3), (26, 4), (26, 5), (26, 6), (26, 7), (26, 8), (26, 9), (26, 10), (26, 11), (26, 36), (26, 37), (26, 38), (26, 45), (26, 46), (26, 47), (26, 54), (26, 55), (26, 56), (27, 9), (27, 10), (27, 11), (27, 36), (27, 37), (27, 38), (27, 45), (27, 46), (27, 47), (27, 54), (27, 55), (27, 56), (28, 9), (28, 10), (28, 11), (28, 36), (28, 37), (28, 38), (28, 45), (28, 46), (28, 47), (28, 54), (28, 55), (28, 56), (29, 9), (29, 10), (29, 11), (29, 36), (29, 37), (29, 38), (29, 45), (29, 46), (29, 47), (29, 54), (29, 55), (29, 56), (30, 9), (30, 10), (30, 11), (30, 18), (30, 19), (30, 20), (30, 21), (30, 22), (30, 23), (30, 24), (30, 25), (30, 26), (30, 27), (30, 28), (30, 29), (30, 30), (30, 31), (30, 32), (30, 33), (30, 34), (30, 35), (30, 36), (30, 37), (30, 38), (30, 45), (30, 46), (30, 47), (30, 48), (30, 49), (30, 50), (30, 51), (30, 52), (30, 53), (30, 54), (30, 55), (30, 56), (31, 9), (31, 10), (31, 11), (31, 18), (31, 19), (31, 20), (31, 21), (31, 22), (31, 23), (31, 24), (31, 25), (31, 26), (31, 27), (31, 28), (31, 29), (31, 30), (31, 31), (31, 32), (31, 33), (31, 34), (31, 35), (31, 36), (31, 37), (31, 38), (31, 45), (31, 46), (31, 47), (31, 48), (31, 49), (31, 50), (31, 51), (31, 52), (31, 53), (31, 54), (31, 55), (31, 56), (32, 9), (32, 10), (32, 11), (32, 18), (32, 19), (32, 20), (32, 21), (32, 22), (32, 23), (32, 24), (32, 25), (32, 26), (32, 27), (32, 28), (32, 29), (32, 30), (32, 31), (32, 32), (32, 33), (32, 34), (32, 35), (32, 36), (32, 37), (32, 38), (32, 45), (32, 46), (32, 47), (32, 48), (32, 49), (32, 50), (32, 51), (32, 52), (32, 53), (32, 54), (32, 55), (32, 56), (36, 9), (36, 10), (36, 11), (37, 9), (37, 10), (37, 11), (38, 9), (38, 10), (38, 11), (39, 9), (39, 10), (39, 11), (40, 9), (40, 10), (40, 11), (41, 9), (41, 10), (41, 11), (42, 3), (42, 4), (42, 5), (42, 6), (42, 7), (42, 8), (42, 9), (42, 10), (42, 11), (42, 12), (42, 13), (42, 14), (42, 15), (42, 16), (42, 17), (42, 18), (42, 19), (42, 20), (42, 24), (42, 25), (42, 26), (42, 33), (42, 34), (42, 35), (42, 36), (42, 37), (42, 38), (42, 39), (42, 40), (42, 41), (42, 42), (42, 43), (42, 44), (42, 45), (42, 46), (42, 47), (42, 48), (42, 49), (42, 50), (42, 51), (42, 52), (42, 53), (42, 54), (42, 55), (42, 56), (42, 57), (42, 58), (42, 59), (42, 60), (43, 3), (43, 4), (43, 5), (43, 6), (43, 7), (43, 8), (43, 9), (43, 10), (43, 11), (43, 12), (43, 13), (43, 14), (43, 15), (43, 16), (43, 17), (43, 18), (43, 19), (43, 20), (43, 24), (43, 25), (43, 26), (43, 33), (43, 34), (43, 35), (43, 36), (43, 37), (43, 38), (43, 39), (43, 40), (43, 41), (43, 42), (43, 43), (43, 44), (43, 45), (43, 46), (43, 47), (43, 48), (43, 49), (43, 50), (43, 51), (43, 52), (43, 53), (43, 54), (43, 55), (43, 56), (43, 57), (43, 58), (43, 59), (43, 60), (44, 3), (44, 4), (44, 5), (44, 6), (44, 7), (44, 8), (44, 9), (44, 10), (44, 11), (44, 12), (44, 13), (44, 14), (44, 15), (44, 16), (44, 17), (44, 18), (44, 19), (44, 20), (44, 24), (44, 25), (44, 26), (44, 33), (44, 34), (44, 35), (44, 36), (44, 37), (44, 38), (44, 39), (44, 40), (44, 41), (44, 42), (44, 43), (44, 44), (44, 45), (44, 46), (44, 47), (44, 48), (44, 49), (44, 50), (44, 51), (44, 52), (44, 53), (44, 54), (44, 55), (44, 56), (44, 57), (44, 58), (44, 59), (44, 60), (45, 24), (45, 25), (45, 26), (45, 33), (45, 34), (45, 35), (46, 24), (46, 25), (46, 26), (46, 33), (46, 34), (46, 35), (47, 24), (47, 25), (47, 26), (47, 33), (47, 34), (47, 35), (48, 24), (48, 25), (48, 26), (48, 33), (48, 34), (48, 35), (49, 24), (49, 25), (49, 26), (49, 33), (49, 34), (49, 35), (50, 24), (50, 25), (50, 26), (50, 33), (50, 34), (50, 35), (51, 24), (51, 25), (51, 26), (52, 24), (52, 25), (52, 26), (53, 24), (53, 25), (53, 26), (54, 24), (54, 25), (54, 26), (55, 24), (55, 25), (55, 26), (56, 24), (56, 25), (56, 26), (57, 24), (57, 25), (57, 26), (57, 33), (57, 34), (57, 35), (58, 24), (58, 25), (58, 26), (58, 33), (58, 34), (58, 35), (59, 24), (59, 25), (59, 26), (59, 33), (59, 34), (59, 35), (60, 24), (60, 25), (60, 26), (60, 33), (60, 34), (60, 35), (6, 1), (6, 2), (7, 1), (7, 2), (8, 1), (8, 2), (24, 1), (24, 2), (25, 1), (25, 2), (26, 1), (26, 2), (42, 1), (42, 2), (43, 1), (43, 2), (44, 1), (44, 2)]

    landmarks_60x60 = [(3, 51), (3, 52), (3, 53), (3, 60), (4, 51), (4, 52), (4, 53), (4, 60), (5, 51), (5, 52), (5, 53), (5, 60), (9, 57), (9, 58), (9, 59), (10, 57), (10, 58), (10, 59), (11, 57), (11, 58), (11, 59), (30, 39), (30, 40), (30, 41), (30, 57), (30, 58), (30, 59), (31, 39), (31, 40), (31, 41), (31, 57), (31, 58), (31, 59), (32, 39), (32, 40), (32, 41), (32, 57), (32, 58), (32, 59), (33, 45), (33, 46), (33, 47), (34, 45), (34, 46), (34, 47), (35, 45), (35, 46), (35, 47), (36, 24), (36, 25), (36, 26), (37, 24), (37, 25), (37, 26), (38, 24), (38, 25), (38, 26), (39, 60), (40, 60), (41, 60), (42, 30), (42, 31), (42, 32), (43, 30), (43, 31), (43, 32), (44, 30), (44, 31), (44, 32), (45, 36), (45, 37), (45, 38), (45, 39), (45, 40), (45, 41), (46, 36), (46, 37), (46, 38), (46, 39), (46, 40), (46, 41), (47, 36), (47, 37), (47, 38), (47, 39), (47, 40), (47, 41), (48, 36), (48, 37), (48, 38), (48, 39), (48, 40), (48, 41), (49, 36), (49, 37), (49, 38), (49, 39), (49, 40), (49, 41), (50, 36), (50, 37), (50, 38), (50, 39), (50, 40), (50, 41), (51, 36), (51, 37), (51, 38), (51, 39), (51, 40), (51, 41), (52, 36), (52, 37), (52, 38), (52, 39), (52, 40), (52, 41), (53, 36), (53, 37), (53, 38), (53, 39), (53, 40), (53, 41), (54, 18), (54, 19), (54, 20), (54, 21), (54, 22), (54, 23), (54, 30), (54, 31), (54, 32), (55, 18), (55, 19), (55, 20), (55, 21), (55, 22), (55, 23), (55, 30), (55, 31), (55, 32), (56, 18), (56, 19), (56, 20), (56, 21), (56, 22), (56, 23), (56, 30), (56, 31), (56, 32), (57, 18), (57, 19), (57, 20), (57, 21), (57, 22), (57, 23), (58, 18), (58, 19), (58, 20), (58, 21), (58, 22), (58, 23), (59, 18), (59, 19), (59, 20), (59, 21), (59, 22), (59, 23), (60, 18), (60, 19), (60, 20), (60, 21), (60, 22), (60, 23)]

    danger_60x60 = [(12, 12), (12, 13), (12, 16), (12, 17), (13, 12), (13, 13), (13, 16), (13, 17), (14, 12), (14, 13), (14, 16), (14, 17), (15, 12), (15, 13), (15, 16), (15, 17), (16, 12), (16, 13), (16, 16), (16, 17), (17, 12), (17, 13), (17, 16), (17, 17), (18, 12), (18, 13), (18, 16), (18, 17), (18, 57), (18, 58), (18, 59), (19, 12), (19, 13), (19, 16), (19, 17), (19, 57), (19, 58), (19, 59), (20, 12), (20, 13), (20, 16), (20, 17), (20, 57), (20, 58), (20, 59), (21, 12), (21, 13), (21, 16), (21, 17), (21, 57), (21, 58), (21, 59), (22, 12), (22, 13), (22, 16), (22, 17), (22, 57), (22, 58), (22, 59), (23, 12), (23, 13), (23, 16), (23, 17), (23, 57), (23, 58), (23, 59), (24, 12), (24, 13), (24, 16), (24, 17), (24, 57), (24, 58), (24, 59), (25, 12), (25, 13), (25, 16), (25, 17), (25, 57), (25, 58), (25, 59), (26, 12), (26, 13), (26, 16), (26, 17), (26, 57), (26, 58), (26, 59), (27, 12), (27, 13), (27, 16), (27, 17), (28, 12), (28, 13), (28, 16), (28, 17), (29, 12), (29, 13), (29, 16), (29, 17), (60, 27), (60, 28), (60, 29), (60, 30), (60, 31), (60, 32)]

    goals_60x60 = [(48, 36), (48, 37), (48, 38), (49, 36), (49, 37), (49, 38), (50, 36), (50, 37), (50, 38), (57, 21), (57, 22), (57, 23), (58, 21), (58, 22), (58, 23), (59, 21), (59, 22), (59, 23)]

    init_states_60x60 = [(1, 13), (1, 14), (1, 15), (2, 13), (2, 14), (2, 15), (1, 40), (1, 41), (1, 42), (2, 40), (2, 41), (2, 42)]

    return GWNavigationPOMDP(
        (60, 60),
        obstacles_60x60,
        landmarks_60x60,
        danger_60x60,
        goals_60x60,
        init_states_60x60;
        scaling_factor=3
    )
end

function scale_grid_world(
    grid_size,
    obstacles,
    landmarks,
    danger,
    goals,
    initial_states,
    scaling_factor
)
    if scaling_factor == 1
        return grid_size, obstacles, landmarks, danger, goals, initial_states
    end

    new_grid_size = (grid_size[1] * scaling_factor, grid_size[2] * scaling_factor)

    function scale_points(points, factor)
        scaled_list = []
        for (x, y) in points
            for i in 1:factor
                for j in 1:factor
                    new_x = (x - 1) * factor + i
                    new_y = (y - 1) * factor + j
                    push!(scaled_list, (new_x, new_y))
                end
            end
        end
        return scaled_list
    end

    scaled_obstacles = scale_points(obstacles, scaling_factor)
    scaled_landmarks = scale_points(landmarks, scaling_factor)
    scaled_danger = scale_points(danger, scaling_factor)
    scaled_goals = scale_points(goals, scaling_factor)
    scaled_initial_states = scale_points(initial_states, scaling_factor)

    return new_grid_size, scaled_obstacles, scaled_landmarks, scaled_danger, scaled_goals, scaled_initial_states
end
